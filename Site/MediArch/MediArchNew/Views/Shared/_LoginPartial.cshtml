@using Microsoft.AspNetCore.Identity
@using MediArch.Models

@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@using MediArch.Services.Interfaces
@inject IApplicationUserService service

@if (SignInManager.IsSignedIn(User))
{
    string Us_Id = service.GetUserIdByUserName(UserManager.GetUserName(User));
    
    <form asp-area="" asp-controller="Account" asp-action="Logout" method="post" id="logoutForm" class="navbar-right">
        <ul class="nav navbar-nav navbar-right">
            <li>
                <a asp-area="" asp-controller="Manage" asp-action="Index" title="More Info">
                    Hello, @service.getUserFirstNameByEmail(UserManager.GetUserName(User))!<!--<img src="@service.GetProfilePictureLink(Us_Id)" style=" height:34px; width:34px; background-size: cover; background-position: top center; border-radius: 50%; background-color:transparent;">-->
                </a>


                
            </li>
            <li>
                <button type="submit" class="btn btn-link navbar-btn navbar-link"><a>Log out <span class="glyphicon glyphicon-log-out"></span></a></button>
            </li>
        </ul>
    </form>
}
else
{
    <style>
        .hidden {
            display: none;
        }

        .unhidden {
            display: block;
        }

        .registration_box {
            background: #222222; /*#fff;*/
            border: 1px solid rgba(50, 50, 50, .4);
            /*border-radius: 0 0 2px 2px;*/
            box-shadow: 0 3px 8px rgba(0, 0, 0, .25);
            color: #9d9d9d;
            position: absolute;
            top: 51px;
            width: 83px;
            z-index: -1;
        }
    </style>

    <script type="text/javascript">
        function hideANDunhide(clickedButton, divID) {
        var item = document.getElementById(divID);
        if (item) {
            if(item.className=='hidden'){
                item.className = 'unhidden' ;
                clickedButton.value = 'Register'
            }else{
                item.className = 'hidden';
                clickedButton.value = 'Register'
            }
        }}
    </script>

    <ul class="nav navbar-nav navbar-right">
        <li>
            <a href="#" type="text" onclick="hideANDunhide(choose, 'choose')">Register</a>
            <div id="choose" class="hidden">
                <div class="registration_box">
                    <center>
                        <br>
                        <p>As a:</p>
                        <a asp-area="" asp-controller="Account" asp-action="RegisterMedic">Medic</a>
                        <hr/>
                        <a asp-area="" asp-controller="Account" asp-action="RegisterPacient">Pacient</a>
                        <br><br>
                    </center>
                </div>
            </div>
        </li>
        <!--<li><a asp-area="" asp-controller="Account" asp-action="RegisterMedic">Register as Medic</a></li>
        <li><a asp-area="" asp-controller="Account" asp-action="RegisterPacient">Register as Pacient</a></li>-->
        <li><a asp-area="" asp-controller="Account" asp-action="Login">Log in</a></li>
    </ul>
}
